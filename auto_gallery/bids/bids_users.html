<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
  
    <title>CARAVEL &mdash; pycaravel</title>
  <!-- htmltitle is before nature.css - we use this hack to load bootstrap first -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" media="screen" />

    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="pycaravel" href="../../index.html" />
  
   
       <script type="text/javascript" src="../../_static/sidebar.js"></script>
   
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="../../_static/js/bootstrap.min.js" type="text/javascript"></script>

  <script src="../../_static/js/angular.min.js" type="text/javascript"></script>
  <script type="text/javascript">
    var app = angular.module("navApp", []);
    app.controller('navCtrl', ['$scope', '$window', function($scope, $window) {
      $scope.isActive = function (viewLocation) {
        var rel = $window.location.pathname.split("/")
        rel = rel[rel.length - 1]
        rel = rel.split(".")[0]
        var active = (viewLocation === rel);
        return active;};
    }]);
  </script>

  </head>
  <body role="document"><div class="banner">
  <div class="container-fluid banner-container">
    <div class="row banner-inner">
      <div class="col-xs-4">
        <img alt="Logo" src="../../_static/caravel.png">
      </div>
      <div class="col-xs-8">
            <p>pycaravel:  Python package that enables you to parse various source of data.</p>
      </div>
    </div>  
  </div>
</div><nav class="navbar navbar-default navbar-static-top">
  <div class="container-fluid">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
        </a>
    </div>
    <div id="navbar" class="navbar-collapse collapse" ng-controller="navCtrl" ng-app="navApp">
      <ul class="nav navbar-nav">
        <li ng-class="{ active: isActive('index') }"><a href="../../index.html">Home</a></li>
        <li ng-class="{ active: isActive('installation') }"><a href="../../generated/installation.html">Installation</a></li>
        <li ng-class="{ active: isActive('gallery') }"><a href="../gallery.html">Gallery</a></li>
        <li ng-class="{ active: isActive('documentation') }"><a href="../../generated/documentation.html">API documentation</a></li>
        <!--<li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"> <span class="caret"></span></a>
          <ul class="dropdown-menu">
	        <li><a href="../../generated/caravel.html">Caravel</a></li>
<li><a href="../../generated/caravel.parsers.html">Caravel.parsers</a></li>
<li><a href="../../generated/caravel.loaders.html">Caravel.loaders</a></li>
          </ul>
        </li>-->
        <li><a href="http://joliot.cea.fr/drf/joliot/Pages/Entites_de_recherche/NeuroSpin.aspx">NeuroSpin webPage</a></li>
      </ul>
    </div>
  </div>
</nav>
<div class="content-wrapper">
    <div class="sphinxsidebar">
      <div class="sphinxsidebarwrapper">

        <!-- info setup -->
          <p class="doc-version">
           This documentation is for caravel <strong>version 0.0.2</strong>
          </p>
        <p class="citing">
          If you use the software, please do not hesitate to 
          <a &mdash; <a href="https://github.com/neurospin/pycaravel">
          Report a Bug</a>.
        </p>

      <!-- toc tree -->
      <ul>
<li><a class="reference internal" href="#">BIDS directory parsing (user mode)</a><ul>
<li><a class="reference internal" href="#first-checks">First checks</a></li>
<li><a class="reference internal" href="#create-a-parser-for-your-project">Create a parser for your project</a></li>
<li><a class="reference internal" href="#and-for-the-derivatives">And for the derivatives</a></li>
</ul>
</li>
</ul>


      </div>
    </div>
  

  <div class="content">
      
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="bids-directory-parsing-user-mode">
<span id="sphx-glr-auto-gallery-bids-bids-users-py"></span><h1>BIDS directory parsing (user mode)<a class="headerlink" href="#bids-directory-parsing-user-mode" title="Permalink to this headline">¶</a></h1>
<p>Credit: A Grigis</p>
<p>pycaravel is a Python package that enables you to parse various source of data.
In this tutorial you will learn how to parse and search in a BIDS directory.</p>
<div class="section" id="first-checks">
<h2>First checks<a class="headerlink" href="#first-checks" title="Permalink to this headline">¶</a></h2>
<p>In order to test if pycaravel package is installed on your machine, you can
check the package version.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">caravel</span>

<span class="k">print</span><span class="p">(</span><span class="n">caravel</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
<p>Now you can run the the configuration info function to see if all the
dependencies are installed properly:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">caravel</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="create-a-parser-for-your-project">
<h2>Create a parser for your project<a class="headerlink" href="#create-a-parser-for-your-project" title="Permalink to this headline">¶</a></h2>
<p>The package provides a common interface to parse a BIDS directory. The
parsing rules are defined by projects in the module, so we will beed to
specify the project name you are working on. For the moement it is not
possible to specify these rules via the API.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">parser</span> <span class="o">=</span> <span class="n">caravel</span><span class="o">.</span><span class="n">get_parser</span><span class="p">(</span>
    <span class="n">project</span><span class="o">=</span><span class="s2">&quot;hbn&quot;</span><span class="p">,</span>
    <span class="n">layoutdir</span><span class="o">=</span><span class="s2">&quot;/neurospin/tmp/pycaravel/layout&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can now list the available configurations for your project, and the
available layout representations pre-generated. Note that these
representations are sorted by dates, and that the latest one will be used.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">conf</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">representation</span><span class="p">)</span>
</pre></div>
</div>
<p>You can export the whole &#8216;sourcedata&#8217; layout in a pandas DataFrame.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">export_layout</span><span class="p">(</span><span class="s2">&quot;sourcedata&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>It is also possible to filter this dataset. You need first to list all the
avaliable filtering keys, then list all the availables values for the
filtering key(s) of interest, and finally filter your dataset.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">list_keys</span><span class="p">(</span><span class="s2">&quot;sourcedata&quot;</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">list_values</span><span class="p">(</span><span class="s2">&quot;sourcedata&quot;</span><span class="p">,</span> <span class="s2">&quot;subject&quot;</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">list_values</span><span class="p">(</span><span class="s2">&quot;sourcedata&quot;</span><span class="p">,</span> <span class="s2">&quot;modality&quot;</span><span class="p">))</span>
<span class="n">search1</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">filter_layout</span><span class="p">(</span><span class="s2">&quot;sourcedata&quot;</span><span class="p">,</span> <span class="n">subject</span><span class="o">=</span><span class="s2">&quot;S01&quot;</span><span class="p">,</span>
                               <span class="n">modality</span><span class="o">=</span><span class="s2">&quot;anat|func&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">search1</span><span class="p">)</span>
<span class="n">search2</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">filter_layout</span><span class="p">(</span><span class="s2">&quot;sourcedata&quot;</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="s2">&quot;tsv&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">search2</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally you may want to ask the system to load the filtered data. Only a
couple of file extensions are supported. If no loader has been found the
filename is returned</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;sourcedata&quot;</span><span class="p">,</span> <span class="n">search1</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;sourcedata&quot;</span><span class="p">,</span> <span class="n">search2</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="and-for-the-derivatives">
<h2>And for the derivatives<a class="headerlink" href="#and-for-the-derivatives" title="Permalink to this headline">¶</a></h2>
<p>We can do the same for the derivatives</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">export_layout</span><span class="p">(</span><span class="s2">&quot;derivatives&quot;</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">list_keys</span><span class="p">(</span><span class="s2">&quot;derivatives&quot;</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">list_values</span><span class="p">(</span><span class="s2">&quot;derivatives&quot;</span><span class="p">,</span> <span class="s2">&quot;process&quot;</span><span class="p">))</span>
<span class="n">search3</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">filter_layout</span><span class="p">(</span><span class="s2">&quot;derivatives&quot;</span><span class="p">,</span> <span class="n">subject</span><span class="o">=</span><span class="s2">&quot;S01&quot;</span><span class="p">,</span>
                               <span class="n">process</span><span class="o">=</span><span class="s2">&quot;spmpreproc&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">search3</span><span class="p">)</span>
<span class="n">data3</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;derivatives&quot;</span><span class="p">,</span> <span class="n">search3</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">data3</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Total running time of the script:</strong> ( 0 minutes  0.000 seconds)</p>
<div class="sphx-glr-footer container">
<div class="sphx-glr-download container">
<a class="reference download internal" href="../../_downloads/bids_users.py" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">bids_users.py</span></code></a></div>
<div class="sphx-glr-download container">
<a class="reference download internal" href="../../_downloads/bids_users.ipynb" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">bids_users.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature">Gallery generated by Sphinx-Gallery</p>
</div>
</div>


          </div>
        </div>
      </div>

    <div class="clearer">
    </div>
  </div>
  
</div>

<div class="footer">
    &copy; 2019, 
Antoine Grigis &lt;antoine.grigis@cea.fr&gt;
 &lt;antoine.grigis@cea.fr&gt;.
</div>
  </body>
</html>